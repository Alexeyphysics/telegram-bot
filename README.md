# PIUS Telegram Bot

**–í–∞—à –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫ –ø–æ –ø–∏—Ç–∞–Ω–∏—é –∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞–º** ü§ñ

---

## üöÄ –û –ø—Ä–æ–µ–∫—Ç–µ

**PIUS Telegram Bot** ‚Äî —ç—Ç–æ –≤–∞—à –ª–∏—á–Ω—ã–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø–∏—Ç–∞–Ω–∏—è –∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫. –ë–æ—Ç –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç—Å—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏, —á—Ç–æ–±—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ.

### ‚ú® –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞–º–∏**  
  - –°–æ–∑–¥–∞–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É –Ω–∏–º–∏.  

- **–î–Ω–µ–≤–Ω–∏–∫ –ø–∏—Ç–∞–Ω–∏—è**  
  - –ó–∞–ø–∏—Å—å –ø—Ä–∏–µ–º–æ–≤ –ø–∏—â–∏ (–≤—Ä—É—á–Ω—É—é –∏–ª–∏ –∏–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–π –±–∞–∑—ã –ø—Ä–æ–¥—É–∫—Ç–æ–≤).  
  - –ü—Ä–æ—Å–º–æ—Ç—Ä —Ä–∞—Ü–∏–æ–Ω–∞ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –¥–∞—Ç—É —Å –ø–æ–¥—Å—á–µ—Ç–æ–º –ë–ñ–£–ö (–±–µ–ª–∫–∏, –∂–∏—Ä—ã, —É–≥–ª–µ–≤–æ–¥—ã, –∫–∞–ª–æ—Ä–∏–∏).  
  - –£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π –∏–∑ –¥–Ω–µ–≤–Ω–∏–∫–∞.  

- **–ë–∞–∑–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ (–ë–ñ–£)**  
  - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤ —Å –∏—Ö –ø–∏—â–µ–≤–æ–π —Ü–µ–Ω–Ω–æ—Å—Ç—å—é (–∫–∞–ª–æ—Ä–∏–∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏).  
  - –ü—Ä–æ—Å–º–æ—Ç—Ä, –ø–æ–∏—Å–∫ –∏ —É–¥–∞–ª–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤.  

- **–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏**  
  - –ó–∞–ø–∏—Å—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π, –≤–µ—Å–∞ –∏ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π.  
  - –ü—Ä–æ—Å–º–æ—Ç—Ä —Ç–µ—Ö–Ω–∏–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π —á–µ—Ä–µ–∑ –≤–Ω–µ—à–Ω–∏–µ –≥–∞–π–¥—ã.  
  - –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –ø–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è–º.  
  - –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ—Ç—Å—Ç–∞—é—â–∏—Ö –≥—Ä—É–ø–ø –º—ã—à—Ü.  

---

## üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **PHP** (–≤–µ—Ä—Å–∏—è ‚â• 8.1)  
- **Laravel Framework** (–¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã CLI-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è)  
- **Telegram Bot SDK**: `irazasyed/telegram-bot-sdk`  
- **HTTP-–∫–ª–∏–µ–Ω—Ç**: `guzzlehttp/guzzle`  
- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏**: Composer  

---

## ‚öôÔ∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **PHP** ‚â• 8.1 —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è–º–∏: `mbstring`, `curl`, `json`, `xml` –∏ –¥—Ä.  
- **Composer** –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏  
- –î–æ—Å—Ç—É–ø –∫ –≤–Ω–µ—à–Ω–∏–º API-—Å–µ—Ä–≤–∏—Å–∞–º:  
  - **Nutrition Service** (—Å–µ—Ä–≤–∏—Å –ø–∏—Ç–∞–Ω–∏—è)  
  - **Workout Assistant** (—Å–µ—Ä–≤–∏—Å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫)  

### üõ†Ô∏è –®–∞–≥–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

1. **–ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π**  
   ```bash
   git clone https://your-repository-url/pius-telegram-bot.git
   cd pius-telegram-bot
   ```

2. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**  
   ```bash
   composer install
   ```

3. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è**  
   - –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª `.env.example` –≤ `.env`:  
     ```bash
     cp .env.example .env
     ```
   - –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å `.env`, —É–∫–∞–∑–∞–≤ —Å–ª–µ–¥—É—é—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è:  
     ```dotenv
     APP_NAME="PIUS Telegram Bot"
     APP_ENV=local  # –∏–ª–∏ production
     APP_KEY=       # –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å –ø–æ–º–æ—â—å—é `php artisan key:generate`
     APP_DEBUG=true # –∏–ª–∏ false –¥–ª—è production
     APP_URL=http://localhost

     LOG_CHANNEL=stack
     LOG_DEPRECATIONS_CHANNEL=null
     LOG_LEVEL=debug  # –∏–ª–∏ info/error –¥–ª—è production

     # –¢–æ–∫–µ–Ω Telegram-–±–æ—Ç–∞ (–ø–æ–ª—É—á–∏—Ç—å —É @BotFather)
     TELEGRAM_BOT_TOKEN="–í–ê–®_–¢–ï–õ–ï–ì–†–ê–ú_–ë–û–¢_–¢–û–ö–ï–ù"

     # –ë–∞–∑–æ–≤—ã–µ URI –≤–Ω–µ—à–Ω–∏—Ö API-—Å–µ—Ä–≤–∏—Å–æ–≤
     NUTRITION_SERVICE_BASE_URI="–ê–î–†–ï–°_–í–ê–®–ï–ì–û_NUTRITION_SERVICE"  # –Ω–∞–ø—Ä–∏–º–µ—Ä, http://localhost:8080
     WORKOUT_SERVICE_BASE_URI="–ê–î–†–ï–°_–í–ê–®–ï–ì–û_WORKOUT_SERVICE"      # –Ω–∞–ø—Ä–∏–º–µ—Ä, http://localhost:8001

     # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –¥–∞–Ω–Ω—ã—Ö (–¥–ª—è bot_users.json; –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã —É—Å—Ç–∞—Ä–µ–ª–∏)
     USER_DATA_PATH="storage/bot/bot_users.json"
     # PRODUCT_DATA_PATH="storage/bot/bot_products.json"  # –£—Å—Ç–∞—Ä–µ–ª–æ
     # DIARY_DATA_PATH="storage/bot/bot_diary.json"       # –£—Å—Ç–∞—Ä–µ–ª–æ
     # TRAINING_LOG_DATA_PATH="storage/bot/bot_trainings.json"  # –£—Å—Ç–∞—Ä–µ–ª–æ
     ```

4. **–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–ª—é—á –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è**  
   ```bash
   php artisan key:generate
   ```

5. **–°–æ–∑–¥–∞—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏**  
   –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `storage/bot/` –∏ `storage/logs/` —Å—É—â–µ—Å—Ç–≤—É—é—Ç –∏ –¥–æ—Å—Ç—É–ø–Ω—ã –¥–ª—è –∑–∞–ø–∏—Å–∏:  
   ```bash
   mkdir -p storage/bot
   mkdir -p storage/logs
   chmod -R 775 storage bootstrap/cache
   ```

### üöÄ –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞

- **–ó–∞–ø—É—Å–∫ —Å Long Polling**  
  ```bash
  php artisan bot:run
  ```

- **–ó–∞–ø—É—Å–∫ –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ (–¥–ª—è —Å–µ—Ä–≤–µ—Ä–∞)**  
  –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ–Ω–µ–¥–∂–µ—Ä –ø—Ä–æ—Ü–µ—Å—Å–æ–≤, –Ω–∞–ø—Ä–∏–º–µ—Ä **Supervisor**. –ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:  
  ```ini
  [program:pius-telegram-bot]
  process_name=%(program_name)s_%(process_num)02d
  command=php /–ø—É—Ç—å/–∫/–ø—Ä–æ–µ–∫—Ç—É/pius-telegram-bot/artisan bot:run
  autostart=true
  autorestart=true
  stopasgroup=true
  killasgroup=true
  user=–∏–º—è_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è_—Å–µ—Ä–≤–µ—Ä–∞  # –Ω–∞–ø—Ä–∏–º–µ—Ä, www-data
  numprocs=1
  redirect_stderr=true
  stdout_logfile=/–ø—É—Ç—å/–∫/–ø—Ä–æ–µ–∫—Ç—É/pius-telegram-bot/storage/logs/supervisor_bot.log
  stopwaitsecs=300
  ```

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

–ö–ª—é—á–µ–≤—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –∏ —Ñ–∞–π–ª—ã:

- **`app/Bot/`**: –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –±–æ—Ç–∞  
  - `BotKernel.php`: –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –∏ —Å–æ—Å—Ç–æ—è–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π  
  - `Constants/States.php`: –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã —Å–æ—Å—Ç–æ—è–Ω–∏–π  
  - `Keyboard/KeyboardService.php`: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Telegram-–∫–ª–∞–≤–∏–∞—Ç—É—Ä  
  - `Service/DataStorageService.php`: –†–∞–±–æ—Ç–∞ —Å —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º –¥–∞–Ω–Ω—ã—Ö (–≤ –æ—Å–Ω–æ–≤–Ω–æ–º –¥–ª—è `bot_users.json`)  

- **`app/Console/Commands/RunTelegramBot.php`**: Artisan-–∫–æ–º–∞–Ω–¥–∞ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞  
- **`config/`**: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã Laravel  
  - `app.php`: –û–±—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è  
  - `telegram.php`: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Telegram Bot SDK  
  - `exercises.php`: –õ–æ–∫–∞–ª—å–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π (–≤—Ä–µ–º–µ–Ω–Ω—ã–π, –¥–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å API)  

- **`storage/bot/`**: –•—Ä–∞–Ω–∏–ª–∏—â–µ JSON-—Ñ–∞–π–ª–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `bot_users.json`)  
- **`storage/logs/`**: –õ–æ–≥–∏ Laravel –∏ –±–æ—Ç–∞  
- **`.env`**: –§–∞–π–ª –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è  

---

## ü§ù –ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –±–æ—Ç–æ–º

1. –ù–∞–π–¥–∏—Ç–µ –±–æ—Ç–∞ –≤ Telegram –ø–æ –µ–≥–æ –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.  
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É `/start`.  
3. –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–µ—Ä–≤–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞.  
4. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏ –º–µ–Ω—é –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ—É–Ω–∫—Ü–∏—è–º.  

---

## üåê –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ API

–ë–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –¥–≤—É–º—è —Å–µ—Ä–≤–∏—Å–∞–º–∏:  

- **Nutrition Service**  
  - URL: `NUTRITION_SERVICE_BASE_URI`  
  - –•—Ä–∞–Ω–∏—Ç –∏ —É–ø—Ä–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–º–∏ –æ –ø—Ä–æ–¥—É–∫—Ç–∞—Ö (–ë–ñ–£) –∏ –¥–Ω–µ–≤–Ω–∏–∫–æ–º –ø–∏—Ç–∞–Ω–∏—è.  

- **Workout Assistant**  
  - URL: `WORKOUT_SERVICE_BASE_URI`  
  - –£–ø—Ä–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–º–∏ –æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞—Ö, —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è—Ö, –ø—Ä–æ–≥—Ä–µ—Å—Å–µ –∏ —Ç–µ—Ö–Ω–∏–∫–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.  

–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ **Bearer-—Ç–æ–∫–µ–Ω—ã**, –∫–æ—Ç–æ—Ä—ã–µ –±–æ—Ç –ø–æ–ª—É—á–∞–µ—Ç –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∞–∫–∫–∞—É–Ω—Ç–∞ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

---

## üìù –ü–ª–∞–Ω—ã –Ω–∞ –±—É–¥—É—â–µ–µ (TODO)

- –ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Ç–∞–ª–æ–≥–∞ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π –∏–∑ API Workout Assistant.  
- –ü–µ—Ä–µ–≤–æ–¥ —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (`bot_users.json`) –Ω–∞ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö Laravel.  
- –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ –¥–ª—è –¥–ª–∏–Ω–Ω—ã—Ö —Å–ø–∏—Å–∫–æ–≤ (–ø—Ä–æ–¥—É–∫—Ç—ã, –¥–Ω–µ–≤–Ω–∏–∫).  
- –£–ª—É—á—à–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫.  
- *–í–∞—à–∏ –∏–¥–µ–∏ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é—Ç—Å—è!*  

---

## ‚ùì –í–æ–ø—Ä–æ—Å—ã –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã –∏–ª–∏ –≤–æ–ø—Ä–æ—Å—ã:  
üìå –°–æ–∑–¥–∞–π—Ç–µ **Issue** –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏.  

---